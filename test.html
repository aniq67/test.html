<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D'NAP KVM - Visualisasi Teknikal 3D</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background-color: #050505; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        }
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            background: rgba(20, 20, 20, 0.7);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            pointer-events: auto; /* Dibenarkan klik untuk butang di dalam */
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        #ui.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateX(-20px);
        }
        .header {
            color: #ff4444;
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 15px;
            letter-spacing: 1px;
            border-bottom: 2px solid #ff4444;
            display: inline-block;
            padding-bottom: 5px;
        }
        .stat-row {
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            gap: 20px;
        }
        .label { color: #aaa; font-size: 0.85rem; text-transform: uppercase; }
        .value { color: #fff; font-weight: bold; }
        .dim-tag { color: #00ff00; }
        .nail-tag { color: #00d9ff; }
        
        /* Butang Kawalan Baru */
        .controls-container {
            position: absolute;
            bottom: 60px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 20;
        }
        button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            backdrop-filter: blur(5px);
            font-size: 0.8rem;
            transition: background 0.2s;
        }
        button:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        
        canvas { display: block; }
        #instructions {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            color: rgba(255,255,255,0.4);
            font-size: 0.8rem;
            pointer-events: none;
        }
    </style>
</head>
<body>

<div id="ui">
    <div class="header">D'NAP KVM</div>
    <div class="stat-row">
        <span class="label">Produk:</span>
        <span class="value">Penanda Sempadan Khas</span>
    </div>
    <div class="stat-row">
        <span class="label">Dimensi Blok:</span>
        <span class="value dim-tag">30L x 40T x 30P cm</span>
    </div>
    <div class="stat-row">
        <span class="label">Dimensi Paku:</span>
        <span class="value nail-tag">13T x 7.3D cm</span>
    </div>
    <div class="stat-row">
        <span class="label">Paku X:</span>
        <span class="value">Silver Shiny</span>
    </div>
</div>

<div class="controls-container">
    <button onclick="toggleUI()" id="btnUI">Sorok Atribut</button>
    <button onclick="toggleFullScreen()">Skrin Penuh</button>
</div>

<div id="instructions">Klik & Seret untuk Putar | Skrol untuk Zoom</div>

<script>
    let scene, camera, renderer, controls;
    let uiVisible = true;

    // Fungsi untuk sorok/tampilkan UI
    function toggleUI() {
        const ui = document.getElementById('ui');
        const btn = document.getElementById('btnUI');
        uiVisible = !uiVisible;
        if (uiVisible) {
            ui.classList.remove('hidden');
            btn.innerText = "Sorok Atribut";
        } else {
            ui.classList.add('hidden');
            btn.innerText = "Tampil Atribut";
        }
    }

    // Fungsi skrin penuh
    function toggleFullScreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }

    function createTextLabel(text, color = "#ffffff", fontSize = 40) {
        const canvas = document.createElement('canvas');
        canvas.width = 320; canvas.height = 100;
        const context = canvas.getContext('2d');
        
        context.fillStyle = "rgba(0,0,0,0.7)";
        context.beginPath();
        context.roundRect(10, 10, 300, 80, 15);
        context.fill();
        
        context.font = `Bold ${fontSize}px Arial`;
        context.fillStyle = color;
        context.textAlign = "center";
        context.textBaseline = "middle";
        context.fillText(text, 160, 50);
        
        const texture = new THREE.CanvasTexture(canvas);
        const spriteMaterial = new THREE.SpriteMaterial({ map: texture, transparent: true, depthTest: false });
        const sprite = new THREE.Sprite(spriteMaterial);
        sprite.scale.set(7, 2.3, 1);
        return sprite;
    }

    function createCurvedTextTexture(text, color) {
        const canvas = document.createElement('canvas');
        canvas.width = 1024; canvas.height = 1024;
        const context = canvas.getContext('2d');
        context.clearRect(0, 0, canvas.width, canvas.height);
        
        context.font = `Bold 110px 'Segoe UI'`;
        context.fillStyle = color;
        context.textAlign = 'center';
        context.shadowColor = "rgba(0,0,0,0.5)";
        context.shadowBlur = 10;

        const radius = 380;
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const characters = text.split('');
        const totalAngle = Math.PI * 0.7;
        const angleStep = totalAngle / characters.length;
        const startAngle = -Math.PI / 2 - (totalAngle / 2);

        characters.forEach((char, i) => {
            const angle = startAngle + i * angleStep + (angleStep/2);
            context.save();
            context.translate(centerX + Math.cos(angle) * radius, centerY + Math.sin(angle) * radius);
            context.rotate(angle + Math.PI / 2);
            context.fillText(char, 0, 0);
            context.restore();
        });
        return new THREE.CanvasTexture(canvas);
    }

    function init() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a0a);
        scene.fog = new THREE.Fog(0x0a0a0a, 100, 300);

        camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 1, 1000);
        camera.position.set(85, 75, 85);

        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);

        controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.maxPolarAngle = Math.PI / 2;

        const ambient = new THREE.AmbientLight(0xffffff, 0.4);
        scene.add(ambient);

        const spotLight = new THREE.SpotLight(0xffffff, 1.2);
        spotLight.position.set(50, 100, 50);
        spotLight.castShadow = true;
        scene.add(spotLight);

        const fillLight = new THREE.DirectionalLight(0xffffff, 0.6);
        fillLight.position.set(-50, 30, -50);
        scene.add(fillLight);

        const blockGeo = new THREE.BoxGeometry(30, 40, 30);
        const blockMat = new THREE.MeshPhysicalMaterial({ 
            color: 0x333333, 
            transparent: true, 
            opacity: 0.25, 
            roughness: 0.2,
            metalness: 0.1,
            transmission: 0.6,
            thickness: 2,
            side: THREE.DoubleSide
        });
        const block = new THREE.Mesh(blockGeo, blockMat);
        block.position.y = 20;
        scene.add(block);

        const edges = new THREE.EdgesGeometry(blockGeo);
        const line = new THREE.LineSegments(edges, new THREE.LineBasicMaterial({ color: 0x00ff00, transparent: true, opacity: 0.4 }));
        line.position.y = 20;
        scene.add(line);

        const lblT = createTextLabel("40cm (T)", "#00ff00"); 
        lblT.position.set(22, 25, 18); 
        scene.add(lblT);

        const lblL = createTextLabel("30cm (L)", "#00ff00"); 
        lblL.position.set(0, -5, 18); 
        scene.add(lblL);

        const lblP = createTextLabel("30cm (P)", "#00ff00"); 
        lblP.position.set(-18, -5, 0); 
        scene.add(lblP);

        const darkGreyMat = new THREE.MeshStandardMaterial({ 
            color: 0x888888, 
            metalness: 0.4, 
            roughness: 0.7 
        });
        
        const nailGroup = new THREE.Group();
        
        const headGeo = new THREE.SphereGeometry(4.5, 32, 24, 0, Math.PI*2, 0, Math.PI/2);
        const head = new THREE.Mesh(headGeo, darkGreyMat);
        head.position.y = 6.5; 
        nailGroup.add(head);

        const shaft = new THREE.Mesh(new THREE.CylinderGeometry(1.2, 1.2, 7, 24), darkGreyMat);
        shaft.position.y = 3.5;
        nailGroup.add(shaft);

        const legGeo = new THREE.CylinderGeometry(1, 1, 9, 24);
        const lLeg = new THREE.Mesh(legGeo, darkGreyMat); 
        lLeg.position.set(-2, -3.5, 0); 
        lLeg.rotation.z = 0.45; 
        nailGroup.add(lLeg);
        
        const rLeg = new THREE.Mesh(legGeo, darkGreyMat); 
        rLeg.position.set(2, -3.5, 0); 
        rLeg.rotation.z = -0.45; 
        nailGroup.add(rLeg);

        nailGroup.position.set(0, 33.5, 0);
        scene.add(nailGroup);

        const lblNailH = createTextLabel("Paku: 13cm", "#00d9ff", 35); 
        lblNailH.position.set(-12, 33, 0); 
        scene.add(lblNailH);

        const lblNailD = createTextLabel("Tapak: 7.3cm", "#00d9ff", 35); 
        lblNailD.position.set(0, 26, 0); 
        scene.add(lblNailD);

        const shinySilverMat = new THREE.MeshStandardMaterial({
            color: 0xffffff, 
            metalness: 1.0, 
            roughness: 0.05,
            emissive: 0x222222
        });
        
        const pakuX = new THREE.Group();
        const bar1 = new THREE.Mesh(new THREE.BoxGeometry(2.5, 0.4, 0.4), shinySilverMat);
        const bar2 = bar1.clone();
        bar1.rotation.y = Math.PI/4;
        bar2.rotation.y = -Math.PI/4;
        pakuX.add(bar1, bar2);
        pakuX.position.set(0, 11.5, 0);
        nailGroup.add(pakuX);

        const textTex = createCurvedTextTexture("D'NAP KVM", "#ff2222");
        const textPlane = new THREE.Mesh(
            new THREE.PlaneGeometry(29, 29), 
            new THREE.MeshBasicMaterial({ map: textTex, transparent: true, side: THREE.DoubleSide })
        );
        textPlane.rotation.x = -Math.PI/2;
        textPlane.position.set(0, 40.1, 0);
        scene.add(textPlane);

        const grid = new THREE.GridHelper(200, 40, 0x222222, 0x111111);
        scene.add(grid);

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    }

    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
    }

    window.onload = () => { 
        init(); 
        animate(); 
    };
</script>

</body>
</html>